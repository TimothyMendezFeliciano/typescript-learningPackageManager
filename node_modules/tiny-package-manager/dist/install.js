"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const node_fetch_1 = require("node-fetch");
const tar = require("tar");
const fs = require("fs-extra");
const log = require("./log");
async function default_1(name, url, location = '') {
    // Prepare for the directory which is for installation
    const path = `${process.cwd()}${location}/node_modules/${name}`;
    // Create directories recursively.
    await fs.mkdirp(path);
    const response = await node_fetch_1.default(url);
    // The response body is a readable stream
    // and the `tar.extract` accepts a readable stream,
    // so we don't need to create a file to disk,
    // and just extract the stuff directly.
    response.body.pipe(tar.extract({ cwd: path, strip: 1 }))
        .on('close', log.tickInstalling); // Update the progress bar
}
exports.default = default_1;
